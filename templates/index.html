<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progress Note</title>
    <!-- Load CSS files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <div class="site-info-box">
        <div class="site-info-line">
            Selected Site: <span class="site-name">{{ selected_site }}</span>
            <span class="separator">|</span>
            Login User: <span class="user-name">{{ current_user.display_name if current_user else 'Unknown' }}</span>
        </div>
    </div>
    
    <style>
        /* Refresh Button Style */
        .btn-refresh {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-refresh:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }

        .btn-refresh:active {
            transform: scale(0.95);
        }

        .btn-refresh.loading {
            background-color: #95a5a6;
            cursor: not-allowed;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <span>Progress Notes</span>
                    <div class="header-buttons" id="headerButtons">
            <button class="btn-view-notes" onclick="window.location.href='/progress-notes'">View Notes</button>
            <!-- Debug information added -->
            <div style="color: white; font-size: 12px; margin: 0 10px;">
                User: {{ current_user.username if current_user else 'None' }} | 
                Role: {{ current_user.role if current_user else 'None' }} | 
                Is Admin: {{ current_user.is_admin() if current_user else 'False' }}
            </div>

            <button class="btn-logout" onclick="window.location.href='/logout'">Logout</button>
        </div>
            <div class="window-controls">
                <span>_</span><span>&#9723;</span><span>X</span>
            </div>
        </header>
        <div class="main-content">
            <aside class="sidebar">
                <div class="sidebar-section client-selection">
                    <div class="form-group">
                        <label for="client">Client:</label>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <select id="client" class="form-control" style="flex: 1;">
                                <option value="">(none)</option>
                                {% if clients %}
                                    {% for client in clients %}
                                        <option value="{{ client.id }}">{{ client.name }} (ID: {{ client.id }})</option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                        </div>
                    </div>
                    <!-- Service selection window - commented out
                    <div class="form-group">
                        <label for="service">Service:</label>
                        <select id="service">
                            <option value="">(none)</option>
                            <option value="service1">General Consultation</option>
                            <option value="service2">Home Care Package</option>
                        </select>
                    </div>
                    Service selection window - commented out -->
                </div>
                <div class="sidebar-section client-details-nav">
                    <div class="no-photo">Please select client</div>
{#                    <ul class="nav-list">#}
{#                        <li class="active">Client details</li>#}
{#                        <li>Medical</li>#}
{#                        <li>Contacts</li>#}
{#                        <li>ACFI</li>#}
{#                        <li>HCP</li>#}
{#                        <li>Card numbers</li>#}
{#                        <li>Life Story</li>#}
{#                    </ul>#}
                </div>
                
            </aside>
            <main class="content-area">
                <div class="tabs">
                    <button class="tab-button active" data-tab="details">Details</button>
                    <button class="tab-button" data-tab="attachments">Attachments (0)</button>
                    <button class="tab-button" data-tab="tasks">Tasks (0)</button>
                </div>
                <div id="details" class="tab-content active">
                    <div class="form-row">
                        <div class="form-group create-date-group">
                            <label for="createDate">Create date</label>
                            <input type="text" id="createDate" value="10 May 2019">
                        </div>
                        <div class="form-group create-time-group">
                            <input type="time" id="createTime" value="15:12">
                        </div>
                        <div class="form-group current-time-group">
                            <button id="currentTimeBtn">Current Time</button>
                        </div>
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="lateEntry">
                            <label for="lateEntry">Late entry</label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group create-date-group">
                            <label for="eventDate">Event date</label>
                            <input type="text" id="eventDate" value="10 May 2019">
                        </div>
                        <div class="form-group create-time-group">
                            <input type="time" id="eventTime" value="15:12">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group event-type-group">
                            <label for="eventType">Event type </label>
                            <select id="eventType">
                                <option value="">(none)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="careArea">Care Area </label>
                            <select id="careArea" class="full-width-select">
                                <option value="">(none)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                         <div class="form-group">
                            <label for="riskRating">Risk rating</label>
                            <select id="riskRating">
                                <option value="">(none)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row notes-section">
                        <label for="notes">Notes</label>
                        <!-- Toolbar - commented out
                        <div class="toolbar">
                            <button title="Bold"><b>B</b></button>
                            <button title="Italic"><i>I</i></button>
                            <button title="Underline"><u>U</u></button>
                            <button title="Strikethrough"><s>S</s></button>
                            <button title="Unordered List">&#8226;</button>
                            <button title="Ordered List">1.</button>
                            <button title="Decrease Indent">&lt;</button>
                            <button title="Increase Indent">&gt;</button>
                            <select id="macro" title="Macro">
                                <option value="">Macro</option>
                                <option value="macro1">Template 1</option>
                                <option value="macro2">Template 2</option>
                            </select>
                        </div>
                        Toolbar - commented out -->
                        <textarea id="notes" rows="8"></textarea>
                        
                        <!-- Action buttons right below Notes -->
                        <div class="floating-actions">
                            <button id="floatingSaveNewBtn">Save & new</button>
                            <button id="floatingSaveCloseBtn">Save & close</button>
                            <button id="floatingCloseBtn">Close</button>
                        </div>
                    </div>
                     <div class="form-row bottom-controls">
                        <!-- Previous versions button - commented out
                        <button id="previousVersionsBtn"><img src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 width=%2212%22 height=%2212%22 fill=%22%23555%22%3E%3Cpath d=%22M12.5 8H11v6l4.75 2.85.75-1.23-4-2.37zm4.5-4.94L15.53 1.53C14.22.48 12.66 0 11 0 6.76 0 3.28 3.04 3.03 7H1l3.89 3.89.07.14L9 7H6.03C6.29 4.19 8.42 2 11 2c1.31 0 2.5.53 3.38 1.38l1.48 1.48L17 3.06zM20 10.11l-3.89-3.89L12 10.11h2.97c-.26 2.81-2.39 5-4.97 5-1.31 0-2.5-.53-3.38-1.38L5.15 12.26 4 13.74l1.47 1.47C6.78 16.52 8.34 17 10 17c4.24 0 7.72-3.04 7.97-7h2.03z%22/%3E%3C/svg%3E" alt="Previous versions"> Previous versions</button>
                        Previous versions button - commented out -->
                        <!-- Flag on noticeboard checkbox - commented out
                        <div class="checkbox-group">
                            <input type="checkbox" id="flagOnNoticeboard">
                            <label for="flagOnNoticeboard">Flag on noticeboard</label>
                        </div>
                        Flag on noticeboard checkbox - commented out -->
                        <!-- Archived checkbox - commented out
                        <div class="checkbox-group">
                            <input type="checkbox" id="archived">
                            <label for="archived">Archived</label>
                        </div>
                        Archived checkbox - commented out -->
                    </div>
                </div>
                <div id="attachments" class="tab-content">
                    <p>Attachments content goes here.</p>
                </div>
                <div id="tasks" class="tab-content">
                    <p>Tasks content goes here.</p>
                </div>
            </main>
        </div>
    </div>
    <!-- Load JavaScript files (at end of body) -->
    <script src="{{ url_for('static', filename='js/progressNoteDB.js') }}"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    
</body>
</html>